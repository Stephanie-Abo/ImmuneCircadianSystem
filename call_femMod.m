%-------------------------------------------------------------------------
% Need to set 3 parameters
% (i) refers to the dose of endotoxin: (1--none), (2--3mg/kg),(3--6mmg/kg),(4--12mg/kg)
% (j) refers to the CT: (1--CT0), (2--CT3), (3--CT6),(4--CT9),(5--CT12), (6--CT15), (7--CT18),(8--CT21)
% "tend" = final simulation time
%-------------------------------------------------------------------------

% note that both CJL males and females experience an 8h-phase advance.
% CT refers to the time in the control model against which the CJL model is compared.
% For example, when it says CT0 below, the actual CJL female model starts at CT16.
% This notation facilitates the monitoring of simulations.

function [Tf,Yf] = call_femMod(i,j,tend)
tSpan = 0:0.1:tend;
% same as in control model
dCA      = 3.1777e-2;
sCA      = 0.004; 
sIL10    =1187.2; 
xIL10d   =713.8094;
dIL10    =95.465;

y13_0 = [0,3,6,12]; 
y18_0 = sIL10*xIL10d/(dIL10*xIL10d - sIL10);
y20_0 = sCA/dCA;

% ------------------CT0-----------------------
y0CT(1,:)=[16.382,1.6356,3.3589,2.4148,0.37327,69.448,0.69435,0.0036157,0.51768, 2.893,0.82444,0.21273,y13_0(i),0,0,0,0,y18_0,0,y20_0];
% ------------------CT3-----------------------
y0CT(2,:)=[19.514,1.8756,3.1193,2.8768,0.27153,77.799,0.74681,0.0044104,0.50632,2.0582,0.9538,0.19035,y13_0(i),0,0,0,0,y18_0,0,y20_0];
% ------------------CT6-----------------------
y0CT(3,:)=[21.592,2.2502,1.9274, 3.383,0.30128,87.747,0.86692,0.0040272,0.51127,1.5931,1.2379,0.16016,y13_0(i),0,0,0,0,y18_0,0,y20_0];
% ------------------CT9-----------------------
y0CT(4,:)=[20.806,2.6078,0.81503,3.9588,0.4849,95.421,1.0051,0.0027741,0.53157,1.5964,1.5833,0.13633,y13_0(i),0,0,0,0,y18_0,0,y20_0];
% ------------------CT12-----------------------
y0CT(5,:)=[18.233,2.7468,0.46307,4.2299,0.68826,96.101,1.0802,0.0019943,0.55077,1.8937,1.7464,0.12983,y13_0(i),0,0,0,0,y18_0,0,y20_0];
% ------------------CT15-----------------------
y0CT(6,:)=[12.264,2.6053,0.3532,3.6205,1.0991,86.042,1.1231  0.00094857,0.58402,3.1536,1.7189,0.14842,y13_0(i),0,0,0,0,y18_0,0,y20_0];
% ------------------CT18-----------------------
y0CT(7,:)=[9.388,2.0371,1.1802,2.6163,1.0842,74.173,0.95841,0.0010338, 0.574,3.9004,1.3263,0.18293,y13_0(i),0,0,0,0,y18_0,0,y20_0];
% ------------------CT21-----------------------
y0CT(8,:)=[13.927,1.6002,3.0106,2.2162,0.53764,66.773,0.71889,0.0027453,0.53294, 3.475,0.8576,0.21513,y13_0(i),0,0,0,0,y18_0,0,y20_0];

lps0=y13_0(i);
y0=y0CT(j,:);
[Tf,Yf] = ode45(@(t,y)femMod(t,y,lps0), tSpan, y0); 
end